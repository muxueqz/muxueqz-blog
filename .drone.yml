---
kind: pipeline
name: default

clone:
  disable: true

steps:
- name: clone
  image: docker:git
  commands:
  - git clone https://github.com/muxueqz/kun.git
  - git clone https://github.com/muxueqz/muxueqz-blog.git

- name: build
  image: nimlang/nim
  commands:
  - nimble install -y nwt markdown
  - cd kun
  - nim c -d:release build.nim
  - rm -rf srcs
  - mv -v ../muxueqz-blog/ srcs
  - mkdir -pv public/tags/
  - ./build

- name: git_push
  image: muxueqz/drone-git-push-by-bash
  settings:
    branch: master
    remote: git@git.coding.net:muxueqz/muxueqz.git
    force: true
    commit: true
    path: ./kun/public
    key:
      from_secret: GIT_PUSH_SSH_KEY
---
kind: signature
hmac: 4a89193111cfa90023e095f6e0751b702aa87fcc96c91cddedfd00c62ead208b

...
